
# Drupal 7 - CVE-2018-7600

## RCE
### 利用链路 
```
$_GET['q'] ->  $router_item -> file_ajax_upload -> render -> RCE
```

### 缺陷代码
```
drupal-7.54/includes/common.inc
function drupal_render(&$elements)

  if (isset($elements['#post_render'])) {
    foreach ($elements['#post_render'] as $function) {
      if (function_exists($function)) {
        $elements['#children'] = $function($elements['#children'], $elements);
      }
    }
  }
```
